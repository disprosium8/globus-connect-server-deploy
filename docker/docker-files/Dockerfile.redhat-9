# syntax=docker/dockerfile:1.3-labs

############## STAGE 1 - Prepare the image for GCS installation ################
FROM redhat/ubi9

RUN <<EOF
    yum install -y coreutils-single gzip sudo tar util-linux
EOF

#
# The Redhat repo doesn't have the remaining dependencies. Grab them from Rocky.
#

# This is the base64 of partials/yum/
COPY <<EOF /yum.64
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
S/9l+v8A26bLxgB4AAA=
EOF

RUN <<EOF
    set -e
    cat /yum.64 | base64 -d | (cd /; tar zxf -)
    yum install -y -c /yum/rockylinux.repo cjose python3
EOF

##################### STAGE 2 - Install GCS using Ansible ######################
# This is the base64 compressed tar of the ansible repo directory
COPY <<EOF /ansible.64
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
OeSQQw45PAn8DwpOKaEAeAAA
EOF

RUN <<EOF
    set -e
    /usr/bin/python3 -m venv /venv
    /venv/bin/pip install --upgrade pip
    /venv/bin/pip install ansible
    cat /ansible.64 | base64 -d | (cd /; tar zxf -)
EOF

#COPY <<EOF /ansible/playbook.yml
#- hosts: all
#  roles:
#    - globus-connect-server
#EOF

ARG GLOBUS_ANSIBLE_OPTIONS

RUN <<EOF
    (cd /ansible; /venv/bin/ansible-playbook playbook.yml ${GLOBUS_ANSIBLE_OPTIONS})
EOF

######################### STAGE 3 - Prepare GCS Image ##########################
LABEL maintainer="support@globus.org"

# This is the base64 compressed tar of entrypoint.sh
COPY <<EOF /entrypoint.64
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
EOF

RUN <<EOF
    cat /entrypoint.64 | base64 -d | tar zxf - > /entrypoint.sh
EOF

# These are the default ports in use by GCSv5.4. Currently, they can not be changed.
#   443 : HTTPD service for GCS Manager API and HTTPS access to collections
#  50000-51000 : Default port range for incoming data transfer tasks
EXPOSE 443/tcp 50000-51000/tcp

# Default command unless overriden with 'docker run --entrypoint'
ENTRYPOINT ["/entrypoint.sh"]
# Default options to ENTRYPOINT unless overriden with 'docker run arg1...'
CMD []
