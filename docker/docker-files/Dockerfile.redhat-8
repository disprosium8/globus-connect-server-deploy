# syntax=docker/dockerfile:1.3-labs

############## STAGE 1 - Prepare the image for GCS installation ################
FROM redhat/ubi8

RUN <<EOF
    yum install -y coreutils-single gzip sudo tar util-linux
EOF

#
# The Redhat repo doesn't have the remaining dependencies. Grab them from CentOS.
#

# This is the base64 of partials/yum/
COPY <<EOF /yum.64
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
S/9l+v8A26bLxgB4AAA=
EOF

RUN <<EOF
    set -e
    cat /yum.64 | base64 -d | (cd /; tar zxf -)
    yum install -y -c /yum/centos-8.repo libnice python3
EOF

##################### STAGE 2 - Install GCS using Ansible ######################
# This is the base64 compressed tar of the ansible repo directory
COPY <<EOF /ansible.64
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
IYcccsghhxxyeBL4Hx3p52MAeAAA
EOF

RUN <<EOF
    set -e
    /usr/bin/python3 -m venv /venv
    /venv/bin/pip install --upgrade pip
    /venv/bin/pip install ansible
    cat /ansible.64 | base64 -d | (cd /; tar zxf -)
EOF

ARG GLOBUS_ANSIBLE_OPTIONS

# Modifying this arg value on the build command line will cause RUN to reinstall
# Globus instead of using the previous, cached iteration (if it exists). Useful
# for speeding up re-runs to get newer Globus versions.
ARG CACHEBUST=1

RUN <<EOF
    (cd /ansible; /venv/bin/ansible-playbook playbook.yml ${GLOBUS_ANSIBLE_OPTIONS})
EOF

######################### STAGE 3 - Prepare GCS Image ##########################
LABEL maintainer="support@globus.org"

# This is the base64 compressed tar of entrypoint.sh
COPY <<EOF /entrypoint.64
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
Kx/H43gcj+NxPI7H8Tgex+eN/wGog4rkACgAAA==
EOF

RUN <<EOF
    cat /entrypoint.64 | base64 -d | tar zxf - > /entrypoint.sh
EOF

# These are the default ports in use by GCSv5.4. Currently, they can not be changed.
#   443 : HTTPD service for GCS Manager API and HTTPS access to collections
#  50000-51000 : Default port range for incoming data transfer tasks
EXPOSE 443/tcp 50000-51000/tcp

# Default command unless overriden with 'docker run --entrypoint'
ENTRYPOINT ["/entrypoint.sh"]
# Default options to ENTRYPOINT unless overriden with 'docker run arg1...'
CMD []
